# AGENTS.md - Personal Blog (howinator.io)

## Overview

Hugo static site blog deployed to https://howinator.io/. Theme is `timberline` (git submodule).

## Key Files

- `config.toml` — Hugo site configuration (title, menus, social links, permalink structure)
- `archetypes/default.md` — Template used by `hugo new` to scaffold new posts
- `content/blog/` — All blog posts (flat directory, no date-based subdirectories)
- `themes/timberline/` — Active theme (git submodule)
- `static/` — Static assets (images in `static/img/`, PDFs, manifest)
- `Containerfile` — Podman container build (multi-stage: Hugo build + nginx)
- `public/` — Build output (generated by running `hugo`)

## Blog Post Format

Posts live in `content/blog/<slug>.md` with YAML frontmatter:

```yaml
---
title: "Post Title Here"
date: 2026-02-07T10:00:00-06:00
draft: true
slug: "post-slug"
categories: ['category1']
tags: ['tag1', 'tag2']
---

Markdown content here.
```

- **Filename**: kebab-case, e.g. `my-new-post.md`
- **Date**: ISO 8601 with timezone offset (author is in US Central, -06:00 CST / -05:00 CDT)
- **Permalink pattern**: `/:year/:month/:day/:slug` (defined in config.toml)
- **Emoji**: Enabled site-wide (`:sunglasses:` etc.)

## Creating a New Post

```bash
hugo new content/blog/my-post-slug.md
```

This scaffolds from `archetypes/default.md`. Then edit the generated file to set `title`, `categories`, `tags`, and write content. Set `draft: false` when ready to publish.

## Building & Previewing

```bash
hugo server -D    # Local dev server (includes drafts)
hugo server       # Local dev server (published posts only)
hugo              # Build static site into public/
```

## Container Build & Deploy

Uses Podman for builds and a Zot registry. Managed via Makefile:

```bash
make build            # Build blog image
make push             # Build + push blog
make deploy           # Build + push blog + pulumi up

make build-cc-live    # Build cc-live image
make deploy-cc-live   # Build + push cc-live + pulumi up

make deploy-all       # Deploy blog + cc-live together

make dev              # Local dev stack (docker compose)
make dev-heartbeat    # Test heartbeat locally
make dev-down         # Tear down local stack
```

- **Registry**: `zot.ui.sparky.best/{personal-blog,cc-live}`
- **Platform**: `linux/amd64`
- **Infra**: Pulumi IaC in `~/projects/homeserver`

## Live Status System (cc-live)

Go WebSocket sidecar that shows a live status dot in the nav when a Claude Code session is active. See `services/cc-live/AGENTS.md` for full details.

**Components:**
- `services/cc-live/` — Go WebSocket service (server-side)
- `scripts/cc-live/` — Heartbeat daemon scripts (client-side, triggered by Claude Code hooks)
- `assets/js/live-status.js` — Browser WebSocket client (~30 lines)
- `layouts/shortcodes/cc-status-dot.html` — Inline status dot shortcode

**Claude Code hooks** (`~/.claude/settings.json`):
- `SessionStart` → `scripts/cc-live/start.sh` (starts heartbeat daemon)
- `SessionEnd` → `scripts/cc-live/stop.sh` (kills daemon, signals stop)
- `SessionEnd` → `scripts/cc-stats/` (processes session stats)

## Claude Code Session Stats

Session stats are collected by `scripts/cc-stats/` (Python, zero deps). See `scripts/cc-stats/AGENTS.md`. Data stored in `data/cc_sessions.json`, rendered by the `cc-sessions` shortcode on the `/claude-log/` page.
